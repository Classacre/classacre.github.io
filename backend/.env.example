# ============================================
# Legaci — Backend .env.example
# Copy to backend/.env and fill in values.
# Never commit backend/.env (see backend/.gitignore)
# ============================================

# --------------------------------------------
# Core runtime
# --------------------------------------------
# development | production
NODE_ENV=development

# Public base URL of the app (scheme + host + optional port)
# Used by WebAuthn & OAuth redirect calculations.
# Local dev default:
NEXTAUTH_URL=http://localhost:3000

# Postgres connection string
# Neon example:
#   postgresql://<user>:<password>@<host>/<db>?sslmode=require
# Local Docker example:
#   postgresql://postgres:postgres@localhost:5432/legaci
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/legaci

# Field-level encryption (AES-256-GCM master key, 32 bytes hex)
# Generate: openssl rand -hex 32
FIELD_ENCRYPTION_KEY=REPLACE_WITH_64_HEX_CHARS

# WebAuthn Relying Party
# RP_ID should match the domain (localhost for local dev)
RP_NAME=Legaci
RP_ID=localhost

# --------------------------------------------
# LLM / Embeddings (OpenRouter + OpenAI Whisper)
# --------------------------------------------
# OpenRouter API key (for chat + embeddings via OpenAI SDK pointed at OpenRouter)
# https://openrouter.ai/keys
OPENROUTER_API_KEY=

# Chat model used via OpenRouter
# Examples: anthropic/claude-3.5-sonnet, openai/gpt-4.1
CHAT_MODEL=anthropic/claude-3.5-sonnet

# Embedding model used via OpenRouter embeddings.create
# Examples:
#   text-embedding-3-large  (dimension 3072)
#   text-embedding-3-small  (dimension 1536)
#   voyageai/voyage-2       (dimension 1024)
EMBEDDING_MODEL=text-embedding-3-large

# Whisper transcription (for /api/sources/ingest)
# If you use OpenAI Whisper, provide the OpenAI API key as well:
OPENAI_API_KEY=

# --------------------------------------------
# Vector DB (Qdrant)
# --------------------------------------------
# Qdrant Cloud URL, e.g. https://<cluster>.a.qdrant.cloud
QDRANT_URL=
# API key from Qdrant Cloud
QDRANT_API_KEY=
# Collection name to store vectors
QDRANT_COLLECTION=legaci_vectors

# IMPORTANT: Must match the embedding model dimension:
#  - text-embedding-3-large  => 3072
#  - text-embedding-3-small  => 1536
#  - voyageai/voyage-2       => 1024
QDRANT_VECTOR_SIZE=3072

# --------------------------------------------
# Redis (BullMQ queues)
# --------------------------------------------
# BullMQ uses a Redis server via ioredis.
# Local Docker example:
#   redis://localhost:6379
# Upstash example (use the rediss URL, not the REST URL):
#   rediss://:<password>@<host>:<port>
REDIS_URL=redis://localhost:6379

# NOTE: Some providers expose UPSTASH_REDIS_REST_URL (HTTP REST). That is NOT a Redis protocol URL.
# BullMQ+ioredis require the Redis protocol URL. Prefer REDIS_URL and leave the REST URL unset.
# UPSTASH_REDIS_REST_URL=

# --------------------------------------------
# TTS (ElevenLabs)
# --------------------------------------------
# https://docs.elevenlabs.io/
ELEVENLABS_API_KEY=
# Optional default voice (falls back to a common voice id if not set)
ELEVENLABS_VOICE_ID=21m00Tcm4TlvDq8ikWAM

# --------------------------------------------
# OAuth — Google
# --------------------------------------------
# Create a Web app OAuth Client ID; Authorized redirect URI must match:
#   <NEXTAUTH_URL>/api/auth/oauth/google/callback
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3000/api/auth/oauth/google/callback

# --------------------------------------------
# OAuth — GitHub
# --------------------------------------------
# Create an OAuth App; Authorization callback URL must match:
#   <NEXTAUTH_URL>/api/auth/oauth/github/callback
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_REDIRECT_URI=http://localhost:3000/api/auth/oauth/github/callback

# --------------------------------------------
# OAuth — Microsoft (Entra)
# --------------------------------------------
# Create an app registration; Redirect URI must match:
#   <NEXTAUTH_URL>/api/auth/oauth/microsoft/callback
MS_CLIENT_ID=
MS_CLIENT_SECRET=
MS_REDIRECT_URI=http://localhost:3000/api/auth/oauth/microsoft/callback

# --------------------------------------------
# Optional flags
# --------------------------------------------
# Example: force HTTPS cookie in dev behind a TLS proxy
# NODE_ENV=production